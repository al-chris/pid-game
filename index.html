<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PID Control Academy - Enhanced Gaming Experience</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Game Overlay -->
    <div class="game-overlay" id="gameOverlay">
        <div class="welcome-screen" id="welcomeScreen">
            <div class="logo">
                <h1>üéì PID Control Academy</h1>
                <p>Master Control Systems Through Interactive Gaming</p>
            </div>
            <div class="player-info">
                <div class="avatar">üë®‚Äçüéì</div>
                <div class="player-details">
                    <h3>Welcome, al-chris!</h3>
                    <p>Control Engineer in Training</p>
                </div>
            </div>
            <div class="game-modes">
                <button class="mode-btn" data-mode="tutorial">
                    <div class="mode-icon">üìö</div>
                    <h3>Tutorial Mode</h3>
                    <p>Learn the basics step by step</p>
                </button>
                <button class="mode-btn" data-mode="challenge">
                    <div class="mode-icon">üèÜ</div>
                    <h3>Challenge Mode</h3>
                    <p>Test your skills with missions</p>
                </button>
                <button class="mode-btn" data-mode="sandbox">
                    <div class="mode-icon">üéÆ</div>
                    <h3>Free Play Mode</h3>
                    <p>Experiment and have fun</p>
                </button>
            </div>
        </div>
    </div>

    <!-- Compact Game HUD -->
    <div class="game-hud">
        <div class="hud-left">
            <div class="player-stats">
                <div class="player-name">al-chris</div>
                <div class="level">Level <span id="playerLevel">1</span></div>
                <div class="experience">
                    <div class="xp-bar">
                        <div class="xp-fill" id="xpFill"></div>
                    </div>
                    <span id="xpText">0/100 XP</span>
                </div>
            </div>
        </div>
        
        <div class="hud-center">
            <div class="mission-info" id="missionInfo">
                <h3 id="missionTitle">Welcome to PID Academy</h3>
                <div class="mission-progress" id="missionProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <span id="progressText">0%</span>
                </div>
            </div>
        </div>

        <div class="hud-right">
            <div class="score-display">
                <div class="score-value" id="scoreValue">0</div>
            </div>
            <button class="settings-toggle" id="settingsToggle" title="Toggle Advanced Settings">‚öôÔ∏è</button>
        </div>
    </div>

    <!-- Main Game Container -->
    <div class="game-container">
        <!-- System Selector -->
        <div class="system-selector">
            <button class="system-btn active" data-example="car">üöó</button>
            <button class="system-btn" data-example="drone">üöÅ</button>
            <button class="system-btn" data-example="temperature">üå°Ô∏è</button>
            <button class="system-btn" data-example="pendulum">‚öñÔ∏è</button>
        </div>

        <!-- Main Game Area -->
        <div class="game-area" id="gameArea">
            <!-- Flight Status Panel (for drone) -->
            <div class="flight-status" id="flightStatus">
                <div class="status-item">
                    <span class="status-label">ALT</span>
                    <span class="status-value" id="altitudeValue">50m</span>
                </div>
                <div class="status-item">
                    <span class="status-label">SPD</span>
                    <span class="status-value" id="speedValue">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">BAT</span>
                    <div class="battery-indicator">
                        <div class="battery-fill" id="batteryFill"></div>
                    </div>
                </div>
                <div class="compass" id="compass">
                    <div class="compass-needle"></div>
                </div>
            </div>

            <!-- Game Stats Panel -->
            <div class="game-stats" id="gameStats">
                <div class="stat-item">
                    <span class="stat-label">Score</span>
                    <span class="stat-value" id="gameScore">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Grade</span>
                    <span class="stat-value grade" id="currentGrade">F</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Mode</span>
                    <span class="stat-value" id="flightMode">NORMAL</span>
                </div>
            </div>

            <!-- Main Animation Container -->
            <div class="animation-container" id="animationContainer">
                <!-- Dynamic content will be inserted here -->
            </div>

            <!-- Active Controls Display -->
            <div class="controls-display" id="controlsDisplay">
                <div class="control-indicator" id="wKey">W</div>
                <div class="control-indicator" id="aKey">A</div>
                <div class="control-indicator" id="sKey">S</div>
                <div class="control-indicator" id="dKey">D</div>
                <div class="control-indicator space" id="spaceKey">SPACE</div>
                <div class="control-indicator shift" id="shiftKey">‚áß BOOST</div>
                <div class="control-indicator ctrl" id="ctrlKey">‚åÉ PRECISION</div>
            </div>

            <!-- Enhanced Pedals -->
            <div class="pedal-container">
                <!-- Brake Pedal (Bottom Left) -->
                <div class="pedal brake-pedal" id="brakePedal">
                    <div class="pedal-surface">
                        <div class="pedal-grip"></div>
                        <div class="pedal-grip"></div>
                        <div class="pedal-grip"></div>
                    </div>
                    <div class="pedal-label">BRAKE</div>
                    <div class="pedal-indicator" id="brakeIndicator"></div>
                </div>

                <!-- Accelerator Pedal (Bottom Right) -->
                <div class="pedal accelerator-pedal" id="acceleratorPedal">
                    <div class="pedal-surface">
                        <div class="pedal-grip"></div>
                        <div class="pedal-grip"></div>
                        <div class="pedal-grip"></div>
                    </div>
                    <div class="pedal-label">ACCEL</div>
                    <div class="pedal-indicator" id="accelIndicator"></div>
                </div>
            </div>
        </div>

        <!-- Collapsible Settings Panel -->
        <div class="settings-panel" id="settingsPanel">
            <div class="panel-header">
                <h3>üéõÔ∏è Advanced Settings</h3>
                <button class="close-panel" id="closePanel">√ó</button>
            </div>
            
            <div class="settings-tabs">
                <button class="tab-btn active" data-tab="pid">PID</button>
                <button class="tab-btn" data-tab="game">Game</button>
                <button class="tab-btn" data-tab="debug">Debug</button>
            </div>

            <div class="tab-content" id="pidTab">
                <div class="control-group">
                    <label>Proportional (Kp) <span class="help-tip" title="Controls immediate response to error">‚ÑπÔ∏è</span></label>
                    <div class="slider-container">
                        <input type="range" class="slider" id="kpSlider" min="0" max="5" step="0.1" value="1.0">
                        <span class="value-display" id="kpValue">1.0</span>
                    </div>
                    <div class="param-feedback" id="kpFeedback"></div>
                </div>

                <div class="control-group">
                    <label>Integral (Ki) <span class="help-tip" title="Eliminates steady-state error">‚ÑπÔ∏è</span></label>
                    <div class="slider-container">
                        <input type="range" class="slider" id="kiSlider" min="0" max="2" step="0.05" value="0.1">
                        <span class="value-display" id="kiValue">0.1</span>
                    </div>
                    <div class="param-feedback" id="kiFeedback"></div>
                </div>

                <div class="control-group">
                    <label>Derivative (Kd) <span class="help-tip" title="Reduces overshoot and oscillation">‚ÑπÔ∏è</span></label>
                    <div class="slider-container">
                        <input type="range" class="slider" id="kdSlider" min="0" max="1" step="0.01" value="0.05">
                        <span class="value-display" id="kdValue">0.05</span>
                    </div>
                    <div class="param-feedback" id="kdFeedback"></div>
                </div>

                <div class="control-group">
                    <label>Target Setpoint</label>
                    <div class="slider-container">
                        <input type="range" class="slider" id="setpointSlider" min="0" max="100" step="1" value="60">
                        <span class="value-display" id="setpointValue">60</span>
                    </div>
                </div>

                <div class="pid-values">
                    <div class="pid-value">
                        <div class="label">P Term</div>
                        <div class="value" id="pTerm">0.0</div>
                    </div>
                    <div class="pid-value">
                        <div class="label">I Term</div>
                        <div class="value" id="iTerm">0.0</div>
                    </div>
                    <div class="pid-value">
                        <div class="label">D Term</div>
                        <div class="value" id="dTerm">0.0</div>
                    </div>
                </div>
            </div>

            <div class="tab-content hidden" id="gameTab">
                <div class="control-group">
                    <label>Difficulty</label>
                    <select id="difficultySelect">
                        <option value="easy">üü¢ Easy</option>
                        <option value="medium">üü° Medium</option>
                        <option value="hard">üî¥ Hard</option>
                        <option value="expert">üíÄ Expert</option>
                    </select>
                </div>

                <div class="control-group">
                    <label>Control Sensitivity</label>
                    <div class="slider-container">
                        <input type="range" class="slider" id="sensitivitySlider" min="0.5" max="2" step="0.1" value="1.0">
                        <span class="value-display" id="sensitivityValue">1.0</span>
                    </div>
                </div>

                <div class="control-group">
                    <label>Audio</label>
                    <div class="checkbox-container">
                        <input type="checkbox" id="soundEnabled" checked>
                        <label for="soundEnabled">Sound Effects</label>
                    </div>
                </div>

                <div class="performance-metrics">
                    <h4>üìä Performance</h4>
                    <div class="metric">
                        <span class="metric-label">Stability</span>
                        <div class="metric-bar">
                            <div class="metric-fill stability" id="stabilityFill"></div>
                        </div>
                        <span class="metric-value" id="stabilityValue">0%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Speed</span>
                        <div class="metric-bar">
                            <div class="metric-fill speed" id="speedFill"></div>
                        </div>
                        <span class="metric-value" id="speedValue">0%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Accuracy</span>
                        <div class="metric-bar">
                            <div class="metric-fill accuracy" id="accuracyFill"></div>
                        </div>
                        <span class="metric-value" id="accuracyValue">0%</span>
                    </div>
                </div>
            </div>

            <div class="tab-content hidden" id="debugTab">
                <div class="chart-container">
                    <canvas id="pidChart" width="300" height="150"></canvas>
                </div>
                
                <div class="debug-controls">
                    <button class="debug-btn" id="pauseBtn">‚è∏Ô∏è Pause</button>
                    <button class="debug-btn" id="resetBtn">üîÑ Reset</button>
                    <button class="debug-btn" id="saveBtn">üíæ Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Control Help Overlay -->
    <div class="control-help" id="controlHelp">
        <div class="help-content">
            <h3>üéÆ Controls</h3>
            <div class="control-list">
                <div class="control-item">
                    <span class="control-key">WASD / Arrow Keys</span>
                    <span class="control-desc">Movement</span>
                </div>
                <div class="control-item">
                    <span class="control-key">Shift</span>
                    <span class="control-desc">Boost Mode</span>
                </div>
                <div class="control-item">
                    <span class="control-key">Ctrl</span>
                    <span class="control-desc">Precision Mode</span>
                </div>
                <div class="control-item">
                    <span class="control-key">Space</span>
                    <span class="control-desc">Emergency Brake</span>
                </div>
                <div class="control-item">
                    <span class="control-key">R</span>
                    <span class="control-desc">Reset Orientation</span>
                </div>
                <div class="control-item">
                    <span class="control-key">1-4</span>
                    <span class="control-desc">Switch Systems</span>
                </div>
                <div class="control-item">
                    <span class="control-key">H</span>
                    <span class="control-desc">Toggle Help</span>
                </div>
            </div>
        </div>
        <button class="close-help" id="closeHelp">√ó</button>
    </div>

    <!-- Floating Notifications -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <div class="achievement-icon">üèÜ</div>
        <div class="achievement-text">
            <div class="achievement-title" id="achievementTitle">Achievement Unlocked!</div>
            <div class="achievement-desc" id="achievementDesc">First Steps</div>
        </div>
    </div>

    <script src="game.js"></script>
</body>
</html>